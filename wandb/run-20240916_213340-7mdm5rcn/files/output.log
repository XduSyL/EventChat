
  0%|                                                                                                                   | 0/772 [00:00<?, ?it/s]/home/user/anaconda3/envs/llava/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/user/anaconda3/envs/llava/lib/python3.10/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/home/user/anaconda3/envs/llava/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1652: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
  0%|▏                                                                                                        | 1/772 [00:34<7:21:37, 34.37s/it]
{'loss': 10.6775, 'learning_rate': 4.1666666666666665e-05, 'epoch': 0.01}

  0%|▎                                                                                                        | 2/772 [00:53<5:27:10, 25.49s/it]

  0%|▍                                                                                                        | 3/772 [01:13<4:52:54, 22.85s/it]

  1%|▌                                                                                                        | 4/772 [01:32<4:32:15, 21.27s/it]


  1%|▊                                                                                                        | 6/772 [02:32<5:50:52, 27.48s/it]
{'loss': 8.8737, 'learning_rate': 0.00025, 'epoch': 0.03}


  1%|█                                                                                                        | 8/772 [03:12<4:59:00, 23.48s/it]
{'loss': 6.6714, 'learning_rate': 0.0003333333333333333, 'epoch': 0.04}

  1%|█▏                                                                                                       | 9/772 [03:33<4:48:14, 22.67s/it]

  1%|█▎                                                                                                      | 10/772 [03:52<4:32:48, 21.48s/it]


  2%|█▌                                                                                                      | 12/772 [04:40<4:56:06, 23.38s/it]
{'loss': 4.6053, 'learning_rate': 0.0005, 'epoch': 0.06}

  2%|█▊                                                                                                      | 13/772 [05:01<4:44:12, 22.47s/it]

  2%|█▉                                                                                                      | 14/772 [05:29<5:05:13, 24.16s/it]

  2%|██                                                                                                      | 15/772 [05:48<4:46:08, 22.68s/it]

  2%|██▏                                                                                                     | 16/772 [06:07<4:31:52, 21.58s/it]

  2%|██▎                                                                                                     | 17/772 [06:27<4:23:36, 20.95s/it]

  2%|██▍                                                                                                     | 18/772 [06:46<4:16:57, 20.45s/it]

  2%|██▌                                                                                                     | 19/772 [07:05<4:10:50, 19.99s/it]

  3%|██▋                                                                                                     | 20/772 [07:24<4:06:25, 19.66s/it]

  3%|██▊                                                                                                     | 21/772 [07:43<4:04:13, 19.51s/it]

  3%|██▉                                                                                                     | 22/772 [08:02<4:03:16, 19.46s/it]

  3%|███                                                                                                     | 23/772 [08:21<4:01:00, 19.31s/it]

  3%|███▏                                                                                                    | 24/772 [08:40<3:59:56, 19.25s/it]

  3%|███▎                                                                                                    | 25/772 [08:59<3:59:03, 19.20s/it]

  3%|███▌                                                                                                    | 26/772 [09:19<3:59:37, 19.27s/it]

  3%|███▋                                                                                                    | 27/772 [09:38<3:59:39, 19.30s/it]

  4%|███▊                                                                                                    | 28/772 [09:58<3:59:50, 19.34s/it]

  4%|███▉                                                                                                    | 29/772 [10:17<3:58:52, 19.29s/it]

  4%|████                                                                                                    | 30/772 [10:36<3:59:20, 19.35s/it]

  4%|████▏                                                                                                   | 31/772 [10:56<3:59:07, 19.36s/it]

  4%|████▎                                                                                                   | 32/772 [11:16<4:00:41, 19.52s/it]

  4%|████▍                                                                                                   | 33/772 [11:35<3:58:28, 19.36s/it]

  4%|████▌                                                                                                   | 34/772 [11:54<3:58:23, 19.38s/it]

  5%|████▋                                                                                                   | 35/772 [12:13<3:58:13, 19.39s/it]

  5%|████▊                                                                                                   | 36/772 [12:33<3:56:56, 19.32s/it]

  5%|████▉                                                                                                   | 37/772 [12:52<3:56:11, 19.28s/it]

  5%|█████                                                                                                   | 38/772 [13:11<3:54:43, 19.19s/it]

  5%|█████▎                                                                                                  | 39/772 [13:30<3:54:57, 19.23s/it]

  5%|█████▍                                                                                                  | 40/772 [13:49<3:54:54, 19.25s/it]

  5%|█████▌                                                                                                  | 41/772 [14:09<3:55:06, 19.30s/it]

  5%|█████▋                                                                                                  | 42/772 [14:28<3:53:53, 19.22s/it]


  6%|█████▉                                                                                                  | 44/772 [15:07<3:56:28, 19.49s/it]
{'loss': 1.0077, 'learning_rate': 0.000998237045228345, 'epoch': 0.23}

  6%|██████                                                                                                  | 45/772 [15:27<3:56:38, 19.53s/it]

  6%|██████▏                                                                                                 | 46/772 [15:46<3:55:06, 19.43s/it]

  6%|██████▎                                                                                                 | 47/772 [16:05<3:52:58, 19.28s/it]

  6%|██████▍                                                                                                 | 48/772 [16:24<3:52:07, 19.24s/it]

  6%|██████▌                                                                                                 | 49/772 [16:44<3:52:33, 19.30s/it]

  6%|██████▋                                                                                                 | 50/772 [17:03<3:51:56, 19.27s/it]

  7%|██████▊                                                                                                 | 51/772 [17:22<3:51:35, 19.27s/it]

  7%|███████                                                                                                 | 52/772 [17:41<3:50:43, 19.23s/it]

  7%|███████▏                                                                                                | 53/772 [18:01<3:51:57, 19.36s/it]


  7%|███████▎                                                                                                | 54/772 [18:20<3:52:24, 19.42s/it]
{'loss': 0.8821, 'learning_rate': 0.0009957679932921996, 'epoch': 0.28}
  7%|███████▍                                                                                                | 55/772 [18:39<3:50:10, 19.26s/it]

  7%|███████▌                                                                                                | 56/772 [18:58<3:48:12, 19.12s/it]

  7%|███████▋                                                                                                | 57/772 [19:17<3:46:27, 19.00s/it]

  8%|███████▊                                                                                                | 58/772 [19:36<3:46:10, 19.01s/it]

  8%|███████▉                                                                                                | 59/772 [19:55<3:47:29, 19.14s/it]

  8%|████████                                                                                                | 60/772 [20:15<3:48:49, 19.28s/it]

  8%|████████▏                                                                                               | 61/772 [20:35<3:49:56, 19.40s/it]

  8%|████████▎                                                                                               | 62/772 [20:54<3:50:05, 19.44s/it]

  8%|████████▍                                                                                               | 63/772 [21:13<3:48:22, 19.33s/it]

  8%|████████▌                                                                                               | 64/772 [21:32<3:47:10, 19.25s/it]

  8%|████████▊                                                                                               | 65/772 [21:52<3:48:36, 19.40s/it]


  9%|█████████                                                                                               | 67/772 [22:31<3:48:32, 19.45s/it]

  9%|█████████▏                                                                                              | 68/772 [22:50<3:47:40, 19.40s/it]
{'loss': 0.7677, 'learning_rate': 0.000991486549841951, 'epoch': 0.35}

  9%|█████████▎                                                                                              | 69/772 [23:10<3:46:41, 19.35s/it]

  9%|█████████▍                                                                                              | 70/772 [23:29<3:45:18, 19.26s/it]


  9%|█████████▋                                                                                              | 72/772 [24:08<3:45:46, 19.35s/it]

  9%|█████████▊                                                                                              | 73/772 [24:27<3:46:17, 19.42s/it]

 10%|█████████▉                                                                                              | 74/772 [24:47<3:45:56, 19.42s/it]
{'loss': 0.8145, 'learning_rate': 0.0009890155085462377, 'epoch': 0.38}

 10%|██████████                                                                                              | 75/772 [25:06<3:45:34, 19.42s/it]

 10%|██████████▏                                                                                             | 76/772 [25:25<3:45:20, 19.43s/it]

 10%|██████████▎                                                                                             | 77/772 [25:45<3:43:55, 19.33s/it]

 10%|██████████▌                                                                                             | 78/772 [26:04<3:43:28, 19.32s/it]

 10%|██████████▋                                                                                             | 79/772 [26:23<3:41:55, 19.21s/it]

 10%|██████████▊                                                                                             | 80/772 [26:42<3:43:11, 19.35s/it]

 10%|██████████▉                                                                                             | 81/772 [27:02<3:43:19, 19.39s/it]

 11%|███████████                                                                                             | 82/772 [27:21<3:42:27, 19.34s/it]

 11%|███████████▏                                                                                            | 83/772 [27:40<3:41:26, 19.28s/it]

 11%|███████████▎                                                                                            | 84/772 [27:59<3:40:16, 19.21s/it]

 11%|███████████▍                                                                                            | 85/772 [28:18<3:39:34, 19.18s/it]

 11%|███████████▌                                                                                            | 86/772 [28:38<3:39:52, 19.23s/it]

 11%|███████████▋                                                                                            | 87/772 [28:57<3:40:15, 19.29s/it]

 11%|███████████▊                                                                                            | 88/772 [29:16<3:39:23, 19.25s/it]


 12%|████████████                                                                                            | 90/772 [29:55<3:38:23, 19.21s/it]
{'loss': 0.6414, 'learning_rate': 0.0009809128215864096, 'epoch': 0.47}

 12%|████████████▎                                                                                           | 91/772 [30:14<3:36:56, 19.11s/it]

 12%|████████████▍                                                                                           | 92/772 [30:33<3:36:14, 19.08s/it]


 12%|████████████▋                                                                                           | 94/772 [31:11<3:36:19, 19.14s/it]
{'loss': 0.6833, 'learning_rate': 0.0009785463014733355, 'epoch': 0.49}

 12%|████████████▊                                                                                           | 95/772 [31:30<3:36:25, 19.18s/it]

 12%|████████████▉                                                                                           | 96/772 [31:49<3:35:11, 19.10s/it]

 13%|█████████████                                                                                           | 97/772 [32:09<3:36:22, 19.23s/it]


 13%|█████████████▎                                                                                          | 99/772 [32:48<3:37:35, 19.40s/it]

 13%|█████████████▎                                                                                         | 100/772 [33:07<3:35:53, 19.28s/it]Checkpoint destination directory /data/SyL/LLaVA/checkpoints/llava-v1.5-7b-pretrain/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
{'loss': 0.6657, 'learning_rate': 0.0009747435008912438, 'epoch': 0.52}
/home/user/anaconda3/envs/llava/lib/python3.10/site-packages/torch/nn/modules/module.py:1879: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/home/user/anaconda3/envs/llava/lib/python3.10/site-packages/torch/utils/checkpoint.py:429: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/home/user/anaconda3/envs/llava/lib/python3.10/site-packages/torch/utils/checkpoint.py:61: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
{'loss': 0.6216, 'learning_rate': 0.0009740803237954829, 'epoch': 0.52}
 13%|█████████████▍                                                                                         | 101/772 [34:44<7:58:42, 42.81s/it]

 13%|█████████████▌                                                                                         | 102/772 [35:03<6:37:52, 35.63s/it]

 13%|█████████████▋                                                                                         | 103/772 [35:22<5:41:57, 30.67s/it]

 13%|█████████████▉                                                                                         | 104/772 [35:41<5:02:29, 27.17s/it]

 14%|██████████████                                                                                         | 105/772 [36:01<4:35:49, 24.81s/it]

 14%|██████████████▏                                                                                        | 106/772 [36:20<4:16:14, 23.09s/it]


 14%|██████████████▍                                                                                        | 108/772 [36:58<3:53:58, 21.14s/it]
{'loss': 0.7003, 'learning_rate': 0.000969204601480461, 'epoch': 0.56}


 14%|██████████████▋                                                                                        | 110/772 [37:36<3:40:53, 20.02s/it]
{'loss': 0.522, 'learning_rate': 0.0009677368596735232, 'epoch': 0.57}

 14%|██████████████▊                                                                                        | 111/772 [37:56<3:38:20, 19.82s/it]


 15%|███████████████                                                                                        | 113/772 [38:34<3:33:52, 19.47s/it]
{'loss': 0.6149, 'learning_rate': 0.0009654733990301689, 'epoch': 0.59}


 15%|███████████████▎                                                                                       | 115/772 [39:12<3:31:14, 19.29s/it]
{'loss': 0.5577, 'learning_rate': 0.0009639233485843495, 'epoch': 0.6}


 15%|███████████████▌                                                                                       | 117/772 [39:50<3:29:15, 19.17s/it]
{'loss': 0.5957, 'learning_rate': 0.0009623405640526243, 'epoch': 0.61}

 15%|███████████████▋                                                                                       | 118/772 [40:10<3:29:51, 19.25s/it]


 16%|████████████████                                                                                       | 120/772 [40:48<3:29:13, 19.25s/it]

 16%|████████████████▏                                                                                      | 121/772 [41:08<3:30:41, 19.42s/it]

 16%|████████████████▎                                                                                      | 122/772 [41:28<3:32:09, 19.58s/it]
{'loss': 0.6822, 'learning_rate': 0.000958241129660755, 'epoch': 0.63}


 16%|████████████████▌                                                                                      | 124/772 [42:06<3:29:25, 19.39s/it]
{'loss': 0.5075, 'learning_rate': 0.0009565446703949416, 'epoch': 0.64}

 16%|████████████████▋                                                                                      | 125/772 [42:26<3:29:05, 19.39s/it]


 16%|████████████████▉                                                                                      | 127/772 [43:04<3:27:18, 19.28s/it]
{'loss': 0.526, 'learning_rate': 0.000953939619302245, 'epoch': 0.66}

 17%|█████████████████                                                                                      | 128/772 [43:23<3:27:08, 19.30s/it]


 17%|█████████████████▎                                                                                     | 130/772 [44:02<3:27:05, 19.35s/it]
{'loss': 0.5293, 'learning_rate': 0.0009512625020460753, 'epoch': 0.67}


 17%|█████████████████▌                                                                                     | 132/772 [44:41<3:25:04, 19.23s/it]
{'loss': 0.5326, 'learning_rate': 0.0009494379298645788, 'epoch': 0.68}

 17%|█████████████████▋                                                                                     | 133/772 [45:00<3:24:49, 19.23s/it]


 17%|██████████████████                                                                                     | 135/772 [45:39<3:24:46, 19.29s/it]
{'loss': 0.584, 'learning_rate': 0.0009466416524254065, 'epoch': 0.7}

 18%|██████████████████▏                                                                                    | 136/772 [45:58<3:23:48, 19.23s/it]


 18%|██████████████████▍                                                                                    | 138/772 [46:36<3:23:40, 19.28s/it]
{'loss': 0.5212, 'learning_rate': 0.0009437744674272352, 'epoch': 0.72}


 18%|██████████████████▋                                                                                    | 140/772 [47:15<3:23:32, 19.32s/it]

 18%|██████████████████▊                                                                                    | 141/772 [47:35<3:23:41, 19.37s/it]
{'loss': 0.6053, 'learning_rate': 0.0009408368300562047, 'epoch': 0.73}


 19%|███████████████████                                                                                    | 143/772 [48:13<3:21:53, 19.26s/it]
{'loss': 0.5862, 'learning_rate': 0.0009388394947836278, 'epoch': 0.74}

 19%|███████████████████▏                                                                                   | 144/772 [48:32<3:22:00, 19.30s/it]

 19%|███████████████████▎                                                                                   | 145/772 [48:51<3:21:00, 19.23s/it]

 19%|███████████████████▍                                                                                   | 146/772 [49:10<3:19:58, 19.17s/it]


 19%|███████████████████▋                                                                                   | 148/772 [49:49<3:20:34, 19.29s/it]
{'loss': 0.5637, 'learning_rate': 0.0009337110019399149, 'epoch': 0.77}

 19%|███████████████████▉                                                                                   | 149/772 [50:08<3:18:55, 19.16s/it]


 20%|████████████████████▏                                                                                  | 151/772 [50:47<3:19:01, 19.23s/it]
{'loss': 0.4975, 'learning_rate': 0.0009305419538309572, 'epoch': 0.78}

 20%|████████████████████▎                                                                                  | 152/772 [51:06<3:18:39, 19.22s/it]


 20%|████████████████████▌                                                                                  | 154/772 [51:45<3:20:58, 19.51s/it]

 20%|████████████████████▋                                                                                  | 155/772 [52:05<3:20:07, 19.46s/it]
{'loss': 0.5404, 'learning_rate': 0.0009262103201370102, 'epoch': 0.8}


 20%|████████████████████▉                                                                                  | 157/772 [52:43<3:18:38, 19.38s/it]
{'loss': 0.512, 'learning_rate': 0.0009239993167235614, 'epoch': 0.81}

 20%|█████████████████████                                                                                  | 158/772 [53:03<3:18:02, 19.35s/it]


 21%|█████████████████████▎                                                                                 | 160/772 [53:41<3:17:00, 19.31s/it]
{'loss': 0.6512, 'learning_rate': 0.0009206267664155906, 'epoch': 0.83}

 21%|█████████████████████▍                                                                                 | 161/772 [54:01<3:16:43, 19.32s/it]


 21%|█████████████████████▋                                                                                 | 163/772 [54:39<3:15:19, 19.24s/it]
{'loss': 0.5006, 'learning_rate': 0.0009171874385979673, 'epoch': 0.84}


 21%|██████████████████████                                                                                 | 165/772 [55:17<3:13:55, 19.17s/it]
{'loss': 0.5252, 'learning_rate': 0.0009148577239745501, 'epoch': 0.85}

 22%|██████████████████████▏                                                                                | 166/772 [55:36<3:13:49, 19.19s/it]


 22%|██████████████████████▍                                                                                | 168/772 [56:15<3:13:41, 19.24s/it]
{'loss': 0.5022, 'learning_rate': 0.0009113083188767056, 'epoch': 0.87}

 22%|██████████████████████▌                                                                                | 169/772 [56:34<3:13:44, 19.28s/it]


 22%|██████████████████████▊                                                                                | 171/772 [57:13<3:13:54, 19.36s/it]
{'loss': 0.5875, 'learning_rate': 0.0009076936156394488, 'epoch': 0.89}

 22%|██████████████████████▉                                                                                | 172/772 [57:33<3:13:02, 19.30s/it]

 22%|███████████████████████                                                                                | 173/772 [57:53<3:15:26, 19.58s/it]


 23%|███████████████████████▎                                                                               | 175/772 [58:31<3:13:49, 19.48s/it]
{'loss': 0.5241, 'learning_rate': 0.0009027734297781576, 'epoch': 0.91}

 23%|███████████████████████▍                                                                               | 176/772 [58:51<3:13:39, 19.50s/it]

 23%|███████████████████████▌                                                                               | 177/772 [59:10<3:12:51, 19.45s/it]


 23%|███████████████████████▉                                                                               | 179/772 [59:49<3:12:26, 19.47s/it]
{'loss': 0.4649, 'learning_rate': 0.0008977395683493793, 'epoch': 0.93}

 23%|███████████████████████▌                                                                             | 180/772 [1:00:09<3:12:11, 19.48s/it]


 24%|███████████████████████▊                                                                             | 182/772 [1:00:48<3:10:30, 19.37s/it]
{'loss': 0.4665, 'learning_rate': 0.0008938904261417087, 'epoch': 0.94}


 24%|████████████████████████                                                                             | 184/772 [1:01:26<3:09:39, 19.35s/it]

 24%|████████████████████████▏                                                                            | 185/772 [1:01:45<3:08:59, 19.32s/it]
{'loss': 0.5409, 'learning_rate': 0.0008899787510097597, 'epoch': 0.96}

